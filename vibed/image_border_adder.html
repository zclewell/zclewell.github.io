<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Border Adder</title>
    <!-- Using Tailwind CSS for modern styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Using the Inter font for a clean, modern look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom styles for the range slider to improve appearance */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 8px;
            background: #e5e7eb; /* gray-200 */
            border-radius: 9999px;
            outline: none;
            opacity: 0.9;
            transition: opacity .2s;
        }
        input[type="range"]:hover {
            opacity: 1;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            background: #3b82f6; /* blue-500 */
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }
        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            background: #3b82f6; /* blue-500 */
            cursor: pointer;
            border-radius: 50%;
            border: 2px solid white;
            box-shadow: 0 0 5px rgba(0,0,0,0.2);
        }
        /* Style for the active color button */
        .color-btn.active {
            background-color: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }
    </style>
</head>
<body class="bg-gray-100 flex items-start justify-center min-h-screen p-4 sm:p-6 lg:p-8">

    <!-- Main application container -->
    <div id="app-container" class="bg-white p-6 sm:p-8 rounded-2xl shadow-lg w-full max-w-5xl text-center transition-all duration-300">
        <h1 class="text-3xl font-bold text-gray-800 mb-2">Image Border Adder</h1>
        <p class="text-gray-500 mb-6">Upload an image, customize the border, and download your new creation.</p>
        
        <!-- Controls section -->
        <div class="controls my-8 flex flex-col gap-6 items-center">
            <!-- File input button -->
            <label for="imageLoader" class="bg-gray-100 hover:bg-gray-200 text-gray-700 font-semibold py-3 px-6 rounded-lg cursor-pointer transition-colors duration-200">
                <span>Select an Image</span>
                <input type="file" id="imageLoader" accept="image/*" class="hidden">
            </label>

            <!-- Border Color Selector -->
            <div id="color-selector" class="flex rounded-full border border-gray-300 p-1 opacity-50 transition-opacity duration-300">
                <button class="color-btn px-4 py-1 rounded-full text-sm font-medium" data-color="transparent">Transparent</button>
                <button class="color-btn px-4 py-1 rounded-full text-sm font-medium active" data-color="black">Black</button>
                <button class="color-btn px-4 py-1 rounded-full text-sm font-medium" data-color="white">White</button>
            </div>

            <!-- Symmetric Padding Checkbox -->
            <div id="symmetric-toggle-container" class="flex items-center gap-2 opacity-50 transition-opacity duration-300">
                <input type="checkbox" id="symmetricCheckbox" class="h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500" checked>
                <label for="symmetricCheckbox" class="font-medium text-gray-700">Symmetric Padding</label>
            </div>
            
            <!-- Sliders Container -->
            <div class="w-full max-w-md">
                <!-- Symmetric Slider -->
                <div id="symmetric-slider-container" class="slider-group w-full flex items-center gap-4 opacity-50 transition-opacity duration-300">
                    <label for="paddingSlider" class="font-medium text-gray-600">All Sides:</label>
                    <input type="range" id="paddingSlider" min="0" max="100" value="10" disabled>
                    <span id="paddingValue" class="font-bold text-gray-800 min-w-[50px] text-left bg-gray-100 px-2 py-1 rounded-md">10%</span>
                </div>
                <!-- Asymmetric Sliders (initially hidden) -->
                <div id="asymmetric-sliders-container" class="hidden w-full flex flex-col gap-4 opacity-50 transition-opacity duration-300">
                    <!-- Top Slider -->
                    <div class="slider-group w-full flex items-center gap-4">
                        <label for="paddingTop" class="font-medium text-gray-600 w-16">Top:</label>
                        <input type="range" id="paddingTop" min="0" max="100" value="10" disabled>
                        <span class="padding-value font-bold text-gray-800 min-w-[50px] text-left bg-gray-100 px-2 py-1 rounded-md">10%</span>
                    </div>
                    <!-- Right Slider -->
                    <div class="slider-group w-full flex items-center gap-4">
                        <label for="paddingRight" class="font-medium text-gray-600 w-16">Right:</label>
                        <input type="range" id="paddingRight" min="0" max="100" value="10" disabled>
                        <span class="padding-value font-bold text-gray-800 min-w-[50px] text-left bg-gray-100 px-2 py-1 rounded-md">10%</span>
                    </div>
                    <!-- Bottom Slider -->
                    <div class="slider-group w-full flex items-center gap-4">
                        <label for="paddingBottom" class="font-medium text-gray-600 w-16">Bottom:</label>
                        <input type="range" id="paddingBottom" min="0" max="100" value="10" disabled>
                        <span class="padding-value font-bold text-gray-800 min-w-[50px] text-left bg-gray-100 px-2 py-1 rounded-md">10%</span>
                    </div>
                    <!-- Left Slider -->
                    <div class="slider-group w-full flex items-center gap-4">
                        <label for="paddingLeft" class="font-medium text-gray-600 w-16">Left:</label>
                        <input type="range" id="paddingLeft" min="0" max="100" value="10" disabled>
                        <span class="padding-value font-bold text-gray-800 min-w-[50px] text-left bg-gray-100 px-2 py-1 rounded-md">10%</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Canvas for image preview -->
        <div class="w-full flex justify-center">
             <canvas id="canvas" class="border-2 border-dashed border-gray-300 rounded-lg mt-2 max-w-full h-auto block transition-all duration-300"></canvas>
        </div>
       
        <!-- Download button -->
        <div class="mt-8">
            <a id="downloadBtn" class="bg-blue-500 text-white font-bold py-3 px-8 rounded-lg shadow-md transition-all duration-200 ease-in-out transform hover:bg-blue-600 hover:-translate-y-1 opacity-50 pointer-events-none" href="#">Download Image</a>
        </div>
    </div>

    <script>
        // --- Element References ---
        const imageLoader = document.getElementById('imageLoader');
        const canvas = document.getElementById('canvas');
        const downloadBtn = document.getElementById('downloadBtn');
        const ctx = canvas.getContext('2d');
        
        // Color controls
        const colorSelector = document.getElementById('color-selector');
        const colorButtons = document.querySelectorAll('.color-btn');

        // Symmetric/Asymmetric controls
        const symmetricCheckbox = document.getElementById('symmetricCheckbox');
        const symmetricToggleContainer = document.getElementById('symmetric-toggle-container');
        const symmetricSliderContainer = document.getElementById('symmetric-slider-container');
        const asymmetricSlidersContainer = document.getElementById('asymmetric-sliders-container');

        // Slider References
        const paddingSlider = document.getElementById('paddingSlider');
        const paddingValue = document.getElementById('paddingValue');
        const individualSliders = [
            { id: 'paddingTop', input: document.getElementById('paddingTop'), display: document.querySelector('#paddingTop + .padding-value') },
            { id: 'paddingRight', input: document.getElementById('paddingRight'), display: document.querySelector('#paddingRight + .padding-value') },
            { id: 'paddingBottom', input: document.getElementById('paddingBottom'), display: document.querySelector('#paddingBottom + .padding-value') },
            { id: 'paddingLeft', input: document.getElementById('paddingLeft'), display: document.querySelector('#paddingLeft + .padding-value') },
        ];

        // --- State ---
        let originalImage = null;
        let originalFileName = null; // <-- NEW: Store the original file name
        let borderColor = 'black';
        let isSymmetric = true;

        // --- Event Listeners ---

        imageLoader.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (!file) return;
            
            originalFileName = file.name; // <-- NEW: Save the file name

            const reader = new FileReader();
            reader.onload = (event) => {
                const img = new Image();
                img.onload = () => {
                    originalImage = img;
                    enableControls();
                    drawImageWithPadding();
                };
                img.src = event.target.result;
            };
            reader.readAsDataURL(file);
        });

        colorButtons.forEach(button => {
            button.addEventListener('click', () => {
                borderColor = button.dataset.color;
                colorButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                if (originalImage) drawImageWithPadding();
            });
        });

        symmetricCheckbox.addEventListener('change', (e) => {
            isSymmetric = e.target.checked;
            toggleSymmetricMode();
            if (originalImage) drawImageWithPadding();
        });

        paddingSlider.addEventListener('input', (e) => {
            paddingValue.textContent = `${e.target.value}%`;
            if (originalImage) drawImageWithPadding();
        });

        individualSliders.forEach(slider => {
            slider.input.addEventListener('input', (e) => {
                slider.display.textContent = `${e.target.value}%`;
                if (originalImage) drawImageWithPadding();
            });
        });

        downloadBtn.addEventListener('click', (e) => {
            if (!originalImage || !originalFileName) {
                e.preventDefault();
                return;
            }

            // --- NEW: Filename generation logic ---
            const dotIndex = originalFileName.lastIndexOf('.');
            const baseName = (dotIndex > -1) ? originalFileName.substring(0, dotIndex) : originalFileName;
            const newFileName = `${baseName}_border_${borderColor}.png`;
            
            downloadBtn.href = canvas.toDataURL('image/png');
            downloadBtn.download = newFileName; // Use the new dynamic filename
        });

        // --- Core Functions ---

        /**
         * The main drawing function. Calculates dimensions based on current state (symmetric/asymmetric, color),
         * resizes the canvas, fills it with the selected border color, and draws the image.
         */
        function drawImageWithPadding() {
            if (!originalImage) return;

            let p = { top: 0, right: 0, bottom: 0, left: 0 };

            if (isSymmetric) {
                const percent = parseInt(paddingSlider.value) / 100;
                p = {
                    top: originalImage.height * percent,
                    right: originalImage.width * percent,
                    bottom: originalImage.height * percent,
                    left: originalImage.width * percent
                };
            } else {
                p = {
                    top: originalImage.height * (parseInt(individualSliders[0].input.value) / 100),
                    right: originalImage.width * (parseInt(individualSliders[1].input.value) / 100),
                    bottom: originalImage.height * (parseInt(individualSliders[2].input.value) / 100),
                    left: originalImage.width * (parseInt(individualSliders[3].input.value) / 100)
                };
            }

            canvas.width = originalImage.width + p.left + p.right;
            canvas.height = originalImage.height + p.top + p.bottom;

            // Clear canvas for transparency
            ctx.clearRect(0, 0, canvas.width, canvas.height);

            if (borderColor !== 'transparent') {
                ctx.fillStyle = borderColor;
                ctx.fillRect(0, 0, canvas.width, canvas.height);
            }

            ctx.drawImage(originalImage, p.left, p.top, originalImage.width, originalImage.height);
        }
        
        /**
         * Toggles the visibility of symmetric vs. asymmetric sliders.
         */
        function toggleSymmetricMode() {
            if (isSymmetric) {
                symmetricSliderContainer.classList.remove('hidden');
                asymmetricSlidersContainer.classList.add('hidden');
            } else {
                symmetricSliderContainer.classList.add('hidden');
                asymmetricSlidersContainer.classList.remove('hidden');
            }
        }

        /**
         * Enables all UI controls after an image is loaded.
         */
        function enableControls() {
            // Enable sliders
            paddingSlider.disabled = false;
            individualSliders.forEach(s => s.input.disabled = false);
            symmetricSliderContainer.classList.remove('opacity-50');
            asymmetricSlidersContainer.classList.remove('opacity-50');
            
            // Enable other controls
            colorSelector.classList.remove('opacity-50');
            symmetricToggleContainer.classList.remove('opacity-50');
            downloadBtn.classList.remove('opacity-50', 'pointer-events-none');
            
            // Update initial value displays
            paddingValue.textContent = `${paddingSlider.value}%`; 
            individualSliders.forEach(s => s.display.textContent = `${s.input.value}%`);
        }
    </script>
</body>
</html>